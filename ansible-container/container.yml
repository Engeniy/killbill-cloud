version: "2"

settings:
  conductor:
    base: ubuntu:xenial
  project_name: killbill

# To be kept in sync with docker/compose/docker-compose.kb.yml
services:
  killbill:
    from: "killbill/killbill:latest"
    ports:
      - "8080:8080"
    dev_overrides:
      ports:
        - "8080:8080"
        - "12345:12345"
    environment:
      - KILLBILL_CONFIG_DAO_URL=jdbc:mysql://db:3306/killbill
      - KILLBILL_CONFIG_DAO_USER=root
      - KILLBILL_CONFIG_DAO_PASSWORD=killbill
  kaui:
    from: killbill/kaui:latest
    ports:
      - "9090:8080"
    environment:
      - KAUI_CONFIG_DAO_URL=jdbc:mysql://db:3306/kaui
      - KAUI_CONFIG_DAO_USER=root
      - KAUI_CONFIG_DAO_PASSWORD=killbill
      - KAUI_KILLBILL_URL=http://killbill:8080
      - KAUI_KILLBILL_API_KEY=bob
      - KAUI_KILLBILL_API_SECRET=lazar
  db:
    from: killbill/mariadb:0.18
    volumes:
      - db:/var/lib/mysql
    expose:
      - "3306"
    environment:
      - MYSQL_ROOT_PASSWORD=killbill
      - MYSQL_ROOT_HOST=%

volumes:
  db:
    docker: {}